{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }} - {{ profile_user.get_full_name }} | JobBoard</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
    <header class="navbar">
        <div class="logo">JDP<span>Jobs</span></div>
        <nav>
            <ul>
                <li><a href="{% url 'home' %}">Home</a></li>
                <li><a href="{% url 'job_list' %}">Jobs</a></li>
                <li><a href="{% url 'network_suggestions' %}">Network</a></li>
                <li><a href="{% url 'profile_view' user.username %}">My Profile</a></li>
            </ul>
        </nav>
    </header>

    <div class="container">
        <div style="max-width: 800px; margin: 0 auto;">
            <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 30px;">
                <a href="{% url 'profile_view' profile_user.username %}" class="btn btn-outline-primary">‚Üê Back to Profile</a>
                <h1>{{ profile_user.get_full_name }}'s {{ title }}</h1>
            </div>

            <!-- Tabs -->
            <div class="tabs" style="margin-bottom: 20px;">
                <a href="?tab=followers" class="tab {% if tab == 'followers' %}active{% endif %}">
                    Followers ({{ profile_user.profile.get_followers_count }})
                </a>
                <a href="?tab=following" class="tab {% if tab == 'following' %}active{% endif %}">
                    Following ({{ profile_user.profile.get_following_count }})
                </a>
            </div>

            <!-- Connections List -->
            <div class="connections-list">
                {% for connection in connections %}
                <div class="connection-card" style="display: flex; align-items: center; justify-content: between; padding: 15px; border-bottom: 1px solid #eee;">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div style="width: 50px; height: 50px; border-radius: 50%; background: #f8f9fa; display: flex; align-items: center; justify-content: center; font-size: 20px;">
                            üë§
                        </div>
                        <div>
                            <h4 style="margin: 0;">
                                <a href="{% url 'profile_view' connection.username %}">
                                    {{ connection.get_full_name|default:connection.username }}
                                </a>
                            </h4>
                            <p style="margin: 0; color: #666; font-size: 0.9em;">
                                {{ connection.profile.headline|default:"Professional" }}
                            </p>
                        </div>
                    </div>
                    {% if user.is_authenticated and user != connection %}
                    <div>
                        {% if user.profile.is_following(connection) %}
                            <button class="btn btn-outline-primary btn-sm" onclick="unfollowUser('{{ connection.username }}')">
                                ‚úì Following
                            </button>
                        {% else %}
                            <button class="btn btn-primary btn-sm" onclick="followUser('{{ connection.username }}')">
                                + Follow
                            </button>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>
                {% empty %}
                <div style="text-align: center; padding: 40px; color: #666;">
                    <p>No {{ title|lower }} found.</p>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <script>
        function followUser(username) {
            fetch(`/profile/${username}/follow/`, {
                method: 'POST',
                headers: {
                    'X-Requested-With': 'XMLHttpRequest',
                    'X-CSRFToken': '{{ csrf_token }}'
                }
            }).then(() => location.reload());
        }

        function unfollowUser(username) {
            fetch(`/profile/${username}/unfollow/`, {
                method: 'POST',
                headers: {
                    'X-Requested-With': 'XMLHttpRequest',
                    'X-CSRFToken': '{{ csrf_token }}'
                }
            }).then(() => location.reload());
        }
    </script>
</body>
</html>